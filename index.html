<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1,minimum-scale=1,maximum-scale=1,user-scalable=no" />
    <title>kaopu</title>
    <link rel="stylesheet/less" href="./static/main.less" />
    <script src="./static/js/jquery-1.11.3.min.js"></script>
		<script src="./static/js/less.min.js"></script>
		<script>
			var Emitter = function(){
				this.list={'any':[]};
			}
			Emitter.prototype={
				once:function(type,obj,callback,once){
					var flag;
					if( once==undefined){
						flag=true;
					}else{
						flag=once;
					}
					var list = this.list;
					if(list[type]==undefined){
						list[type]=[];
					}
					list[type].push({'subscriber':obj,'callback':callback,'once':flag});
				},
				sub:function(type,obj,callback){
					this.once(type,obj,callback,false);
				},
				emit:function(type,args){
					var list = this.list;
					if(list[type]==undefined){return;}
					for(var i=0;i<list[type].length;i++){
						list[type][i].callback.call(list[type][i].subscriber,args);
						if(list[type][i].once){
							list[type].splice(i,1);
						}
					}
				}
			}
			var a = "";
			var emitter = new Emitter();
			emitter.sub('test',a,function(arg1){
				console.log(arg1);
			});
			emitter.emit('test','fafdsa');
		</script>
  </head>
  <body>
	    <div id="app"></div>
	    <!-- built files will be auto injected -->
  </body>
</html>
